#################################
#	File:	fp_events.txt
#	Author:	Chris Saiko
# 	Desc:	Fylkir Powers Events
#			Various triggered and MTTH events in the Fylkir Powers mod.
#			fp.101 - Unused
#			fp.102 - Unused
#			fp.103 - Unused
#			fp.200 - Fix norse laws
#			fp.300 - Ask Fylkir for money
#			fp.999 - Event testing
#################################

namespace = fp				#event namespace

#Unused - 101
character_event = {
	id = fp.101		#event ID
	hide_from = yes
	picture = GFX_evt_pagan_reformation 	#Needs a default picture, even if it won't actually show up
	desc = EVTDESCfp.101		#description

	#Fast event triggers
	is_triggered_only = yes
	only_playable = yes
	ai = no

	trigger = {}
	mean_time_to_happen = {}
	immediate = {}

	#can excommunicate
	option = {
		name = EVTOPTAfp.101
		trigger = {}
		#excommunicate command block
		norse_pagan_reformed = {
			set_can_excommunicate = no
			religion_authority = {
				modifier = fp_change_doctrine
				years = 2
			}
		}
		FROM = {		#Fylkir expends 50 to change doctrine
			piety = -50
		}
	}

	#can grant divorce
	option = {
		name = EVTOPTBfp.101
		trigger = {
			#norse_pagan_reformed = { can_grant_divorce = no }
		}
		#religious head command block
		norse_pagan_reformed = { set_can_grant_divorce = yes }
		FROM = {		#Fylkir expends 50 change doctrine
			piety = -50
		}
	}

	#can grant claims
	option = {
		name = EVTOPTCfp.101
		trigger = {
			#norse_pagan_reformed = { can_grant_claim = no }
		}
		#grant claim command block
		norse_pagan_reformed = { set_can_grant_claim = yes }
		FROM = {		#Fylkir expends 50 change doctrine
			piety = -50
		}
	}

	#changed my mind
	option = {
		name = EVTOPTDfp.101
		trigger = {}
		#changed my mind block
		FROM = {		#Fylkir expends 25 piety to change mind
			piety = -25
		}
	}

	after = {}
}

#Unused - 102
character_event = {
	id = fp.102		#event ID
	hide_from = yes
	picture = GFX_evt_pagan_reformation 	#Needs a default picture, even if it won't actually show up
	desc = EVTDESCfp.102		#description

	#Fast event triggers
	ai = no
	only_playable = yes
	is_triggered_only = yes

	trigger = {}
	mean_time_to_happen = {}
	immediate = {}

	#can excommunicate
	option = {
		name = EVTOPTAfp.102
		trigger = {}
		#invasion command block
		norse_pagan_reformed = { set_can_grant_invasion_cb = invasion }
		FROM = {		#Fylkir expends 50 change doctrine
			piety = -50
		}
	}

	#religious head defended by other members of the faith
	option = {
		name = EVTOPTBfp.102
		trigger = {}
		#religious head command block
		norse_pagan_reformed = { set_rel_head_defense = yes }
		FROM = {		#Fylkir expends 50 change doctrine
			piety = -50
		}
	}

	#option C block
	option = {
		name = EVTOPTCfp.102
		trigger = {}
		#Option C command block
	}

	#option D block
	option = {
		name = EVTOPTDfp.102
		trigger = {}
		#Option D command block
	}

	after = {}
}

#Unused - 103
character_event = {
	id = fp.103		#event ID
	hide_from = yes
	picture = GFX_evt_pagan_reformation 	#Needs a default picture, even if it won't actually show up
	desc = EVTDESCfp.103		#description

	#Fast event triggers
	ai = no
	only_playable = yes
	is_triggered_only = yes

	trigger = {}
	mean_time_to_happen = {}
	immediate = {}

	#can excommunicate
	option = {
		name = EVTOPTAfp.103
		trigger = {}
		#invasion command block
		norse_pagan_reformed = { set_can_grant_invasion_cb = invasion }
		FROM = {		#Fylkir expends 50 change doctrine
			piety = -50
		}
	}

	#religious head defended by other members of the faith
	option = {
		name = EVTOPTBfp.103
		trigger = {}
		#religious head command block
		norse_pagan_reformed = { set_rel_head_defense = yes }
		FROM = {		#Fylkir expends 50 change doctrine
			piety = -50
		}
	}

	#option C block
	option = {
		name = EVTOPTCfp.103
		trigger = {}
		#Option C command block
	}

	#option D block
	option = {
		name = EVTOPTDfp.103
		trigger = {}
		#Option D command block
	}

	after = {}
}

#on_war_ended_victory: Fix norse laws on winning holy war
# From = Attacker, Root = Defender
character_event = {
	id = fp.200		#event ID
	hide_window = yes

	trigger = {
		FROM = {
			religion = norse_pagan_reformed	#norse pagan reformed
			controls_religion = yes			#only the Fylkir(a) can do this
		}
	}

	is_triggered_only = yes

	immediate = {

		#Excommunication and Divorce
		if = {
			limit = {
				FROM = { has_law = fp_excomm_law_0 }
			}
			norse_pagan_reformed = {
				set_can_excommunicate = no
				set_can_grant_divorce = no
			}
		}#end if
		else_if = {
			limit = {
				FROM = { has_law = fp_excomm_law_1 }
			}
			norse_pagan_reformed = {
				set_can_excommunicate = yes
				set_can_grant_divorce = no
			}
		}#end else_if
		else_if = {
			limit = {
				FROM = { has_law = fp_excomm_law_2 }
			}
			norse_pagan_reformed = {
				set_can_excommunicate = yes
				set_can_grant_divorce = yes
			}
		}#end else_if

		#Invasion and religious head defense
		if = {
			limit = {
				FROM = { has_law = fp_inv_def_law_0 }
			}
			norse_pagan_reformed = {
				set_can_grant_invasion_cb = no
				set_rel_head_defense = no
			}
		}#end if
		else_if = {
			limit = {
				FROM = { has_law = fp_inv_def_law_1 }
			}
			norse_pagan_reformed = {
				set_can_grant_invasion_cb = invasion
				set_rel_head_defense = no
			}
		}#end else_if
		else_if = {
			limit = {
				FROM = { has_law = fp_inv_def_law_2 }
			}
			norse_pagan_reformed = {
				set_can_grant_invasion_cb = invasion
				set_rel_head_defense = yes
			}
		}#end else_if

		#Claims and money
		if = {
			limit = {
				FROM = { has_law = fp_claims_law_0 }
			}
			norse_pagan_reformed = {
				set_can_grant_claim = no
			}
		}#end if
		else_if = {
			limit = {
				FROM = { has_law = fp_claims_law_1 }
			}
			norse_pagan_reformed = {
				set_can_grant_claim = no
			}
		}#end else_if
		else_if = {
			limit = {
				FROM = { has_law = fp_claims_law_2 }
			}
			norse_pagan_reformed = {
				set_can_grant_claim = yes
			}
		}#end else_if


	}#end immediate block

	after = {}
}#end fp.200

#MTTH version of fp.200 - Fix norse laws on winning holy war
#  in case the player "forgets"
character_event = {
	id = fp.201		#event ID
	hide_window = yes

	#pre-triggers
	only_playable = yes
	religion = norse_pagan_reformed	#norse pagan reformed

	trigger = {
		controls_religion = yes			#only the Fylkir(a) can do this
	}

	is_triggered_only = no

	mean_time_to_happen = {
		months = 6
	}

	immediate = {

		#Excommunication and Divorce
		if = {
			limit = {
				has_law = fp_excomm_law_0
			}
			norse_pagan_reformed = {
				set_can_excommunicate = no
				set_can_grant_divorce = no
			}
		}#end if
		else_if = {
			limit = {
				has_law = fp_excomm_law_1
			}
			norse_pagan_reformed = {
				set_can_excommunicate = yes
				set_can_grant_divorce = no
			}
		}#end else_if
		else_if = {
			limit = {
				has_law = fp_excomm_law_2
			}
			norse_pagan_reformed = {
				set_can_excommunicate = yes
				set_can_grant_divorce = yes
			}
		}#end else_if

		#Invasion and religious head defense
		if = {
			limit = {
				has_law = fp_inv_def_law_0
			}
			norse_pagan_reformed = {
				set_can_grant_invasion_cb = no
				set_rel_head_defense = no
			}
		}#end if
		else_if = {
			limit = {
				has_law = fp_inv_def_law_1
			}
			norse_pagan_reformed = {
				set_can_grant_invasion_cb = invasion
				set_rel_head_defense = no
			}
		}#end else_if
		else_if = {
			limit = {
				has_law = fp_inv_def_law_2
			}
			norse_pagan_reformed = {
				set_can_grant_invasion_cb = invasion
				set_rel_head_defense = yes
			}
		}#end else_if

		#Claims and money
		if = {
			limit = {
				has_law = fp_claims_law_0
			}
			norse_pagan_reformed = {
				set_can_grant_claim = no
			}
		}#end if
		else_if = {
			limit = {
				has_law = fp_claims_law_1
			}
			norse_pagan_reformed = {
				set_can_grant_claim = no
			}
		}#end else_if
		else_if = {
			limit = {
				has_law = fp_claims_law_2
			}
			norse_pagan_reformed = {
				set_can_grant_claim = yes
			}
		}#end else_if


	}#end immediate block

	after = {}
}#end fp.201

#Ask Fylkir for Money - fp.300
letter_event = {
	id = fp.300
	desc = EVTDESCfp.300
	border = GFX_event_letter_frame_religion

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			set_variable = { which = transfer_money value = 0 }
			change_variable = { which = transfer_money which = price which = event_target:selling_province }

			event_target:raiding_adventurer = {
				set_variable = { which = transfer_money value = 0 }
				change_variable = { which = transfer_money which = price which = event_target:selling_province }
				multiply_variable = { which = transfer_money value = -1 }
			}
		}
	}

	# Give Gold
    option = {
        name = EVTOPTAfp.300
        custom_tooltip = { text = EVTOPTA_TTfp.300 }

        hidden_effect = {}

        ai_chance = {}

		#command block opt A
		#letter_event = { id = fp.301 }

	}

	# No Gold
    option = {
        name = EVTOPTBfp.300
        custom_tooltip = { text = EVTOPTB_TTfp.300 }

        hidden_effect = {}

        ai_chance = {}

		#command block opt B
		#letter_event = { id = fp.302 }
	}
}#end fp.300

#Found the Jarnhendur - fp.400
narrative_event = {
	id = fp.400
	title = EVTNAMEfp.400
	desc = EVTDESCfp.400
	picture = GFX_evt_viking_battle_oldgods
	border = GFX_event_narrative_frame_war

	is_triggered_only = yes

	hide_from = yes

	option = {
		name = EVTOPTAfp.400
	}
}#end fp.400

#EVENTS TESTING - 900
character_event = {		#event type
	id = fp.999				#event ID
	hide_from = yes
    picture = GFX_evt_battle 	#Needs a default picture, even if it won't actually show up
	desc = EVTDESCfp.999		#description

	#Fast event triggers
	is_triggered_only = yes
	only_playable = yes
	ai = no

	trigger = {}
	mean_time_to_happen = {}
	immediate = {}

	#option A block
	option = {
		name = EVTOPTAfp.999
		trigger = {}

		#Option A command block
	}

	#option B block, changed mind
	option = {
		name = EVTOPTBfp.999
		trigger = {}
		#Option B command block
	}

	after = {}
}#end fp.900
