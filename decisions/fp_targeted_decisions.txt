#################################
#	File:	fp_targeted_decisions.txt
#	Author:	Chris Saiko
# 	Desc:	Fylkir Powers Targeted Decisions
#
#			Member Requests
#				fp_ask_for_money
#
#			Grant various Boons
#				fp_cure_disease
#				fp_calm_mind
#				fp_heal_body
#				fp_heal_defect
#				fp_extend_life
#
#			Inflict various Curses
#				fp_inflict_gloom
#				fp_inflict_madness
#				fp_inflict_illness
#				fp_inflict_malady
#				fp_inflict_aberration
#
#			Punish Prisoners
#				vassal_castrate_decision
#				vassal_blinding_decision
#
#			Future Possibilities:
#				Grant Immortality?
#				Make Barren/Sterile
#				Sap Health
#				Crown Rulers?
#				Sumbel/Blot for Child?
#				Release Plague?
#				Heal Realm
#				Cure Realm
#				Curse Title?
#				Curse Dynasty?
#				Peasant Unrest? Revolt?
#				Death?
#################################

targeted_decisions = {

	### Members asking for money
	# This is not something that can be added to a religion with a religion setting
	# It is reimplemented using a decision to mimic the same type of mechanic
	fp_ask_for_money = {
		ai_check_interval = 12 # Determines how seldom the AI checks whether they can and should do the decision, in months. By default 1 (every month).
		filter = all			#everyone gets to do this, might need to try to prune this for performance reasons, but rel_head doesn't seem to work
		ai_target_filter = all
		from_potential = {
			#Conditions on the decision taker for the decision to appear. Not taken into account when filter = self, use potential instead.
			has_dlc = "Holy Fury"	#require the holy fury dlc
			is_playable = yes		#playable characters only
			religion_head = {		#fylkir (or whoever?) has the appropriate laws
				OR = {
					has_law = fp_claims_law_1
					has_law = fp_claims_law_2
				}
			}
			NOT = { trait = excommunicated }
			has_regent = no
			is_adult = yes			#adult, child can never ask for money

			#has not recently asked for money
			NOT = { has_character_modifier = fp_ask_money_timer }

			#these below could be redundant if the religious laws are implemented

			# OR = {
			# 	religion = norse_pagan_reformed	#norse pagan reformed
			# 	#religion = zun_pagan_reformed	#zunist pagan reformed
			# 									#other religions?
			# }

			#these two features together are required to gain such control
			# has_religion_feature = religion_dogmatic		#must have dogmatic
			# has_religion_feature = religion_temporal_head	#secular ruler exists, the Fylkirate

		}#end from_potential block

		potential = {
			#Conditions on the targeted character for the decision to appear
			controls_religion = yes				#only the Fylkir(a) can grant money
			religion = norse_pagan_reformed		#must be germanic reformed pagan to even be an option
			NOT = {trait = incapable}
			is_adult = yes
			has_regent = no

		}#end potential block

		allow = {
			#Conditions for the decision to be enabled

			# can't add stuff like variables inside conditionals to get a precise piety required
			# (game might be hardcoded? cheaters)
			# minimum seems to be about 105 piety for a count
			FROM = {
				piety = 105
			}

			#Redundant, handled in from_potential block above
			# FROM = { NOT = { has_character_modifier = fp_ask_money_timer } }

			# Fylkir must have (yearly income)x2.5 wealth
			# need to figure out how to reference the asker's scaled wealth
			# for now, just make sure the Fylkir has enough for a chunk of cash
			ROOT = {
				scaled_wealth = 2.5
			}

			#Fylkir must at least tolerate you to ask
			ROOT = {
				opinion = { who = FROM value = 0 }
			}
		
		}#end allow block

		effect = {
			#Commands executed when taking the decision

			#envelope event asking for gold
			ROOT = {
				letter_event = { id = fp.300 }
			}
			FROM = {
				add_character_modifier = {	#three year cooldown
					name = fp_ask_money_timer
					months = 36
					hidden = yes
				}
			}
			opinion = {
				modifier = asked_for_money
				who = FROM
				months = 480
			}
			FROM = {
				piety = -105
			}
		}#end effect block

		ai_will_do = {
			#Factors for an AI character to take the decision (1 = 100% chance every month - for each allowed target!)
			factor = 0.9

			# characters with funds will not ask
			modifier = {
				factor = 0
				FROM = { wealth = 100 }
			}

			#shy, content, or proud less likely
			modifier = {
				factor = 0.5
				FROM = {
					OR = {
						trait = shy
						trait = content
						trait = proud
					}
				}
			}

			# #characters with low piety less likely
			# modifier = {
			# 	factor = 0.5
			# 	FROM = {
			# 		NOT = { piety = 120 }
			# 	}
			# }

			#greedy or ambitious characters more likely
			modifier = {
				factor = 1.2
				FROM = {
					OR = {
						trait = greedy
						trait = ambitious
					}
				}
			}

			#poor characters more likely
			modifier = {
				factor = 1.2
				FROM = {
					NOT = { wealth = 10 }
				}
			}

			#bankrupt and in a war very likely
			modifier = {
				factor = 2.0
				FROM = {
					AND = {
						NOT = { wealth = 0 }
						war = yes
					}
				}
			}

		}#end ai_will_do block

		ai_acceptance = {
			factor = 0 		# The base score
			yes_threshold = 50	# At what point to switch from "maybe" to "yes".
								# Defaults to 0, meaning it will never be "maybe"
			show_maybe_for_human = no # Whether to always show "maybe" for human targets (defined as ROOT being controlled by a player). Defaults to "yes"

			additive_modifier = { # Any type of modifier can be used, but "additive" is recommended as it is the most intuitive to the end user. Works same way as MTTHs, ai_will_do, and so on
				value = 10
				localisation_key = "fp_ai_base"
				always = yes
			}
			additive_modifier = {
				value = -10
				localisation_key = "fp_ai_greedy"
				trait = greedy
			}
			additive_modifier = {
				value = 10
				localisation_key = "fp_ai_charitable"
				trait = charitable
			}
			additive_modifier = {
				value = 10
				localisation_key = "fp_ai_piety"
				FROM = { piety = 200 }
			}
			additive_modifier = {
				value = 10
				localisation_key = "fp_ai_opinion"
				FROM = { opinion = {who = ROOT value = 25} }
			}
		}#end ai_acceptance block
	}#end fp_ask_for_money



	### BOONS GRANTED BY FYLKIR ###

	# CURE DISEASE - The Fylkir may, at his discretion, cure an illness or disease
	# from a member of the faith, in exchange for 50 piety.
	fp_cure_disease = {
		filter = all_including_me		#Fylkir, heal thyself
		ai_target_filter = self
		ai_check_interval = 12 # Determines how seldom the AI checks whether they can and should do the decision, in months. By default 1 (every month).
		from_potential = {
			#Conditions on the decision taker for the decision to appear. Not taken into account when filter = self, use potential instead.
			has_dlc = "Holy Fury"				#require the holy fury dlc
			ai = no								#no AI usage
			is_playable = yes					#playable characters only
			is_adult = yes						#adult, no child Fylkirs
			has_game_rule = {
				name = supernatural_events		#require supernatural events game rule
				value = unrestricted
			}
			OR = {
				religion = norse_pagan_reformed	#norse pagan reformed
				#religion = zun_pagan_reformed	#zunist pagan reformed
												#other religions?
			}

			#these two features together are required to gain such control
			has_religion_feature = religion_dogmatic		#must have dogmatic
			has_religion_feature = religion_temporal_head	#secular ruler exists, the Fylkirate

			#The Fylkir must harness the power of the peoples' worship as high god of the religion
			has_religion_feature = religion_holy_family

			controls_religion = yes				#only the Fylkir(a) can do this
		}#end from_potential block

		potential = {
			#Conditions on the targeted character for the decision to appear
			religion = norse_pagan_reformed		#must be germanic reformed pagan to even be an option for the Fylkir
			NOT = { trait = excommunicated }	#must not be excommunicated
			OR = {								#must have at least one disease to cure
				trait = has_aztec_disease
				trait = has_typhus				#aka camp fever
				trait = cancer
				trait = has_tuberculosis		#aka consumption
				trait = dancing_plague
				trait = dysentery
				trait = flu
				trait = food_poisoning
				trait = gout
				trait = syphilitic				#aka great pox
				trait = has_typhoid_fever		#aka slow fever
				trait = ill						#for reaper's due dlc
				trait = leper
				trait = has_measles
				trait = pneumonic
				trait = rabies
				trait = scurvy
				trait = sickly
				trait = has_small_pox
				trait = has_bubonic_plague		#aka The Plague
				trait = infection				#similar to a wound, but put here
				trait = lovers_pox				#the herp
			}
		}#end potential block

		allow = {
			#Conditions for the decision to be enabled

			FROM = {
				piety = 300			#Fylkir must first have at least 300 piety
			}

			OR = {
				FROM = {
					opinion = {
						who = ROOT		#Fylkir opinion of target at least 0...
						value = 0
						}
				}

				AND = {					#OR...
					FROM = {
						opinion = {
						who = ROOT		#Fylkir opinion of target above -25...
						value = -25
						}
					}
					OR = {				#AND target must be some sort of virtuous
						trait = chaste
						trait = temperate
						trait = charitable
						trait = diligent
						trait = patient
						trait = kind
						trait = humble
					}
				}
			}
		}#end allow block

		effect = {
			#Commands executed when taking the decision
			#remove illness
			#minor diseases are more likely to be removed
			random_list = {
				4 = {
					modifier = {
						factor = 0			#skip if no cancer (-3)
						NOT = { trait = cancer }
					}
					#remove_trait = cancer
					#character_event = { id = RIP.11020 }	#recover from cancer, doesn't seem to work
					remove_trait = cancer
				}
				3 = {
					modifier = {
						factor = 0			#skip if no aztec disease (-4)
						NOT = { trait = has_aztec_disease }
					}
					remove_trait = has_aztec_disease
				}
				3 = {
					modifier = {
						factor = 0			#skip if no camp fever (-4)
						NOT = { trait = has_typhus }
					}
					remove_trait = has_typhus
				}
				5 = {
					modifier = {
						factor = 0			#skip if no consumption (-2)
						NOT = { trait = has_tuberculosis }
					}
					remove_trait = has_tuberculosis
				}
				5 = {
					modifier = {
						factor = 0			#skip if no dancing plague (-2)
						NOT = { trait = dancing_plague }
					}
					remove_trait = dancing_plague
				}
				3 = {
					modifier = {
						factor = 0			#skip if no dysentery (-4)
						NOT = { trait = dysentery }
					}
					remove_trait = dysentery
				}
				5 = {
					modifier = {
						factor = 0			#skip if no flu (-2)
						NOT = { trait = flu }
					}
					remove_trait = flu
				}
				4 = {
					modifier = {
						factor = 0			#skip if no food_poisoning (-3)
						NOT = { trait = food_poisoning }
					}
					remove_trait = food_poisoning
				}
				5 = {
					modifier = {
						factor = 0			#skip if no gout (-2)
						NOT = { trait = gout }
					}
					remove_trait = gout
				}
				5 = {
					modifier = {
						factor = 0			#skip if no great pox (-2)
						NOT = { trait = syphilitic }
					}
					remove_trait = syphilitic
				}
				4 = {
					modifier = {
						factor = 0			#skip if no slow fever (-3)
						NOT = { trait = has_typhoid_fever }
					}
					remove_trait = has_typhoid_fever
				}
				5 = {
					modifier = {
						factor = 0				#skip if no ill (-1)
						NOT = { trait = ill	}	#for no reaper's due dlc
					}
					remove_trait = ill
				}
				5 = {
					modifier = {
						factor = 0			#skip if no leper (-1.5)
						NOT = { trait = leper }
					}
					remove_trait = leper
				}
				5 = {
					modifier = {
						factor = 0			#skip if no measles (-2)
						NOT = { trait = has_measles }
					}
					remove_trait = has_measles
				}
				3 = {
					modifier = {
						factor = 0			#skip if no pneumonic (-4)
						NOT = { trait = pneumonic }
					}
					remove_trait = pneumonic
				}
				2 = {
					modifier = {
						factor = 0			#skip if no rabies (-7)
						NOT = { trait = rabies }
					}
					remove_trait = rabies
				}
				4 = {
					modifier = {
						factor = 0			#skip if no scurvy (-3)
						NOT = { trait = scurvy }
					}
					remove_trait = scurvy
				}
				5 = {
					modifier = {
						factor = 0			#skip if no sickly (-2.5)
						NOT = { trait = sickly }
					}
					remove_trait = sickly
				}
				4 = {
					modifier = {
						factor = 0			#skip if no small pox (-3)
						NOT = { trait = has_small_pox }
					}
					remove_trait = has_small_pox
				}
				2 = {
					modifier = {
						factor = 0			#skip if no The Plague (-7)
						NOT = { trait = has_bubonic_plague }
					}
					remove_trait = has_bubonic_plague
				}
				5 = {
					modifier = {
						factor = 0			#skip if no infection (-2)
						NOT = { trait = infection }
					}
					remove_trait = infection
				}
				6 = {
					modifier = {
						factor = 0			#skip if no lovers pox (-N/A)
						NOT = { trait = lovers_pox }
					}
					remove_trait = lovers_pox
				}
			}#end random_list

			#if bedridden illness modifier exists, remove that
			remove_character_modifier = bedridden_illness

			#for now, keep physician treatment modifiers

			#remove any symptoms, although these should be gone if illness has manifested
			# remove_trait = abdominal_pain
			# remove_trait = chest_pain
			# remove_trait = cough
			# remove_trait = cramps
			# remove_trait = diarrhea
			# remove_trait = fatigue
			# remove_trait = fever
			# remove_trait = headache
			# remove_trait = infection
			# remove_trait = malaise
			# remove_trait = rash
			# remove_trait = vomiting

			FROM = {		#Fylkir expends 50 piety to cure diseases and symptoms
				piety = -50
			}

			opinion = {
				modifier = fp_cured_me
				who = FROM
				months = 24
			}
		}#end effect block
	}#end fp_cure_disease

	# CALM MIND - The Fylkir may, at his discretion, cure lunacy, possession,
	# depression, or stress from a member of the faith, in exchange for 50 piety.
	# Additionally lisp and stutter may be removed, as maladies of the mind.
	fp_calm_mind = {
		filter = all_including_me		#Fylkir, heal thyself
		ai_target_filter = self
		ai_check_interval = 12 # Determines how seldom the AI checks whether they can and should do the decision, in months. By default 1 (every month).
		from_potential = {
			#Conditions on the decision taker for the decision to appear. Not taken into account when filter = self, use potential instead.
			has_dlc = "Holy Fury"				#require the holy fury dlc
			ai = no								#no AI usage
			is_playable = yes					#playable characters only
			is_adult = yes						#adult, no child Fylkirs
			has_game_rule = {
				name = supernatural_events		#require supernatural events game rule
				value = unrestricted
			}
			OR = {
				religion = norse_pagan_reformed	#norse pagan reformed
				#religion = zun_pagan_reformed	#zunist pagan reformed
												#other religions?
			}

			#these two features together are required to gain such control
			has_religion_feature = religion_dogmatic		#must have dogmatic
			has_religion_feature = religion_temporal_head	#secular ruler exists, the Fylkirate

			#The Fylkir must harness the power of the peoples' worship as high god of the religion
			has_religion_feature = religion_holy_family

			controls_religion = yes				#only the Fylkir(a) can do this
		}#end from_potential block

		potential = {
			#Conditions on the targeted character for the decision to appear
			religion = norse_pagan_reformed		#must be germanic reformed pagan to even be an option for the Fylkir
			NOT = { trait = excommunicated }	#must not be excommunicated
			OR = {								#must have at least mental problem to cure
				trait = lunatic
				trait = depressed
				trait = stressed
				trait = possessed
				trait = lisp
				trait = stutter
			}
		}#end potential block

		allow = {
			#Conditions for the decision to be enabled

			FROM = {
				piety = 300			#Fylkir must first have at least 300 piety
			}

			OR = {
				FROM = {
					opinion = {
						who = ROOT		#Fylkir opinion of target at least 0...
						value = 0
						}
				}

				AND = {					#OR...
					FROM = {
						opinion = {
						who = ROOT		#Fylkir opinion of target above -25...
						value = -25
						}
					}
					OR = {				#AND target must be some sort of virtuous
						trait = chaste
						trait = temperate
						trait = charitable
						trait = diligent
						trait = patient
						trait = kind
						trait = humble
					}
				}
			}
		}#end allow block

		effect = {
			#Commands executed when taking the decision
			#remove mental afflictions
			#stress and depressed are more likely with weight 3
			#lunatic and possessed are less likely with weight 2
			#lisp and stutter are the least likely with weight 1
			random_list = {
				1 = {
					modifier = {
						factor = 0			#skip if no lisp
						NOT = { trait = lisp }
					}
					remove_trait = lisp
				}
				1 = {
					modifier = {
						factor = 0			#skip if no stutter
						NOT = { trait = stutter }
					}
					remove_trait = stutter
				}
				2 = {
					modifier = {
						factor = 0			#skip if no lunatic
						NOT = { trait = lunatic }
					}
					remove_trait = lunatic
				}
				2 = {
					modifier = {
						factor = 0			#skip if not possessed
						NOT = { trait = possessed }
					}
					remove_trait = possessed
				}
				3 = {
					modifier = {
						factor = 0			#skip if not stressed
						NOT = { trait = stressed }
					}
					remove_trait = stressed
				}
				3 = {
					modifier = {
						factor = 0			#skip if not depressed
						NOT = { trait = depressed }
					}
					remove_trait = depressed
				}
			}#end random_list

			FROM = {		#Fylkir expends 50 piety to cure mental problems
				piety = -50
			}
			opinion = {
				modifier = fp_calmed_me
				who = FROM
				months = 24
			}
		}#end effect block
	}#end fp_calm_mind

	# HEAL BODY - The Fylkir may, at his discretion, heal a wound or disfigurement
	# from a member of the faith, in exchange for 75 piety.
	fp_heal_body = {
		filter = all_including_me		#Fylkir, heal thyself
		ai_target_filter = self
		ai_check_interval = 12 # Determines how seldom the AI checks whether they can and should do the decision, in months. By default 1 (every month).
		from_potential = {
			#Conditions on the decision taker for the decision to appear. Not taken into account when filter = self, use potential instead.
			has_dlc = "Holy Fury"				#require the holy fury dlc
			ai = no								#no AI usage
			is_playable = yes					#playable characters only
			is_adult = yes						#adult, no child Fylkirs
			has_game_rule = {
				name = supernatural_events		#require supernatural events game rule
				value = unrestricted
			}
			OR = {
				religion = norse_pagan_reformed	#norse pagan reformed
				#religion = zun_pagan_reformed	#zunist pagan reformed
												#other religions?
			}

			#these two features together are required to gain such control
			has_religion_feature = religion_dogmatic		#must have dogmatic
			has_religion_feature = religion_temporal_head	#secular ruler exists, the Fylkirate

			#The Fylkir must harness the power of the peoples' worship as high god of the religion
			has_religion_feature = religion_holy_family

			controls_religion = yes				#only the Fylkir(a) can do this
		}#end from_potential block

		potential = {
			#Conditions on the targeted character for the decision to appear
			religion = norse_pagan_reformed		#must be germanic reformed pagan to even be an option for the Fylkir
			NOT = { trait = excommunicated }	#must not be excommunicated
			OR = {								#must have a disfigurement or wound to cure
				trait = disfigured
				trait = mangled
				trait = one_eyed
				trait = one_handed
				trait = one_legged
				trait = severely_injured
				trait = infirm
				trait = maimed
				trait = wounded
				trait = blinded
			}
		}#end potential block

		allow = {
			#Conditions for the decision to be enabled

			FROM = {
				piety = 400			#Fylkir must first have at least 400 piety
			}

			OR = {
				FROM = {
					opinion = {
						who = ROOT		#Fylkir opinion of target at least 0...
						value = 0
						}
				}

				AND = {					#OR...
					FROM = {
						opinion = {
						who = ROOT		#Fylkir opinion of target above -25...
						value = -25
						}
					}
					OR = {				#AND target must be some sort of virtuous
						trait = chaste
						trait = temperate
						trait = charitable
						trait = diligent
						trait = patient
						trait = kind
						trait = humble
					}
				}
			}
		}#end allow block

		effect = {
			#Commands executed when taking the decision
			#remove mental afflictions
			#one eyed/hand/leg and wound are more likely with weight 3
			#disfigured, mangled, maimed, severely_injured, and infirm are less likely with weight 2

			random_list = {
				2 = {
					modifier = {
						factor = 0			#skip if not disfigured
						NOT = { trait = disfigured }
					}
					remove_trait = disfigured
				}
				2 = {
					modifier = {
						factor = 0			#skip if not mangled
						NOT = { trait = mangled }
					}
					remove_trait = mangled
				}
				2 = {
					modifier = {
						factor = 0			#skip if not maimed
						NOT = { trait = maimed }
					}
					remove_trait = maimed
				}
				2 = {
					modifier = {
						factor = 0			#skip if not severely_injured
						NOT = { trait = severely_injured }
					}
					remove_trait = severely_injured
				}
				2 = {
					modifier = {
						factor = 0			#skip if not infirm
						NOT = { trait = infirm }
					}
					remove_trait = infirm
				}
				3 = {
					modifier = {
						factor = 0			#skip if not one_eyed
						NOT = { trait = one_eyed }
					}
					remove_trait = one_eyed
				}
				3 = {
					modifier = {
						factor = 0			#skip if not blinded
						NOT = { trait = blinded }
					}
					remove_trait = blinded
				}
				3 = {
					modifier = {
						factor = 0			#skip if not one_handed
						NOT = { trait = one_handed }
					}
					remove_trait = one_handed
				}
				3 = {
					modifier = {
						factor = 0			#skip if not one_legged
						NOT = { trait = one_legged }
					}
					remove_trait = one_legged
				}
				3 = {
					modifier = {
						factor = 0			#skip if not wounded
						NOT = { trait = wounded }
					}
					remove_trait = wounded
				}
			}#end random_list

			FROM = {		#Fylkir expends 75 piety to cure disfigurement
				piety = -75
			}
			opinion = {
				modifier = fp_healed_me_body
				who = FROM
				months = 48
			}
		}#end effect block
	}#end fp_heal_body

	# HEAL DEFECT - The Fylkir may, at his discretion, remove a defect or
	# aberration trait from a member of the faith, in exchange for 100 piety.
	fp_heal_defect = {
		filter = all_including_me		#Fylkir, heal thyself
		ai_target_filter = self
		ai_check_interval = 12 # Determines how seldom the AI checks whether they can and should do the decision, in months. By default 1 (every month).
		from_potential = {
			#Conditions on the decision taker for the decision to appear. Not taken into account when filter = self, use potential instead.
			has_dlc = "Holy Fury"				#require the holy fury dlc
			ai = no								#no AI usage
			is_playable = yes					#playable characters only
			is_adult = yes						#adult, no child Fylkirs
			has_game_rule = {
				name = supernatural_events		#require supernatural events game rule
				value = unrestricted
			}
			OR = {
				religion = norse_pagan_reformed	#norse pagan reformed
				#religion = zun_pagan_reformed	#zunist pagan reformed
												#other religions?
			}

			#these two features together are required to gain such control
			has_religion_feature = religion_dogmatic		#must have dogmatic
			has_religion_feature = religion_temporal_head	#secular ruler exists, the Fylkirate

			#The Fylkir must harness the power of the peoples' worship as high god of the religion
			has_religion_feature = religion_holy_family

			controls_religion = yes				#only the Fylkir(a) can do this
		}#end from_potential block

		potential = {
			#Conditions on the targeted character for the decision to appear
			religion = norse_pagan_reformed		#must be germanic reformed pagan to even be an option for the Fylkir
			NOT = { trait = excommunicated }	#must not be excommunicated
			OR = {								#must have an aberration to cure
				trait = clubfooted	#these can be rectified at any time
				trait = harelip
				trait = hunchback

				AND = {
					NOT = { age = 5 }
					OR = {
						trait = dwarf	#these can only be rectified at an age under 5
						trait = giant
						trait = slow
						trait = ugly
						trait = weak
					}
				}

				AND = {
					NOT = { age = 2 }
					trait = inbred	#inbred can only be rectified at an age under 2
				}

			}
		}#end potential block

		allow = {
			#Conditions for the decision to be enabled

			FROM = {
				piety = 500			#Fylkir must first have at least 500 piety
			}

			OR = {
				FROM = {
					opinion = {
						who = ROOT		#Fylkir opinion of target at least 0...
						value = 0
						}
				}

				AND = {					#OR...
					FROM = {
						opinion = {
						who = ROOT		#Fylkir opinion of target above -25...
						value = -25
						}
					}
					OR = {				#AND target must be some sort of virtuous
						trait = chaste
						trait = temperate
						trait = charitable
						trait = diligent
						trait = patient
						trait = kind
						trait = humble
					}
				}
			}
		}#end allow block

		effect = {
			#Commands executed when taking the decision
			#remove mental afflictions
			#clubfooted, harelip, and hunchback are more likely with weight 3
			#dwarf, giant, slow, ugly, and weak are less likely with weight 2

			random_list = {
				2 = {
					modifier = {
						factor = 0		#skip if not inbred
						NOT = { trait = inbred }
					}
					modifier = {
						factor = 0		#skip if age over 2
						age = 2
					}
					remove_trait = inbred
				}
				2 = {
					modifier = {
						factor = 0		#skip if not dwarf
						NOT = { trait = dwarf }
					}
					modifier = {
						factor = 0		#skip if age over 5
						age = 6
					}
					remove_trait = dwarf
				}
				2 = {
					modifier = {
						factor = 0		#skip if not giant
						NOT = { trait = giant }
					}
					modifier = {
						factor = 0		#skip if age over 5
						age = 6
					}
					remove_trait = giant
				}
				2 = {
					modifier = {
						factor = 0		#skip if not slow
						NOT = { trait = slow }
					}
					modifier = {
						factor = 0		#skip if age over 5
						age = 6
					}
					remove_trait = slow
				}
				2 = {
					modifier = {
						factor = 0		#skip if not ugly
						NOT = { trait = ugly }
					}
					modifier = {
						factor = 0		#skip if age over 5
						age = 6
					}
					remove_trait = ugly
				}
				2 = {
					modifier = {
						factor = 0		#skip if not weak
						NOT = { trait = weak }
					}
					modifier = {
						factor = 0		#skip if age over 5
						age = 6
					}
					remove_trait = weak
				}
				3 = {
					modifier = {
						factor = 0			#skip if not hunchback
						NOT = { trait = hunchback }
					}
					remove_trait = hunchback
				}
				3 = {
					modifier = {
						factor = 0			#skip if not harelip
						NOT = { trait = harelip }
					}
					remove_trait = harelip
				}
				3 = {
					modifier = {
						factor = 0			#skip if not clubfooted
						NOT = { trait = clubfooted }
					}
					remove_trait = clubfooted
				}
			}#end random_list

			FROM = {		#Fylkir expends 100 piety to cure disfigurement
				piety = -100
			}
			opinion = {
				modifier = fp_healed_me_defect
				who = FROM
				months = 60
			}
		}#end effect block
	}#end fp_heal_defect

	# EXTEND LIFE - The Fylkir may, at his discretion, extend the life of a member
	# of the faith by two years, in exchange for 100 piety, and a year of his own life.
	fp_extend_life = {
		filter = all_including_me		#Fylkir can extend own life by one year
		ai_target_filter = self
		ai_check_interval = 12 # Determines how seldom the AI checks whether they can and should do the decision, in months. By default 1 (every month).
		from_potential = {
			#Conditions on the decision taker for the decision to appear. Not taken into account when filter = self, use potential instead.
			has_dlc = "Holy Fury"				#require the holy fury dlc
			ai = no								#no AI usage
			is_playable = yes					#playable characters only
			OR = {
				is_adult = yes					#adult, no child Fylkirs
				trait = lunatic					#not likely, but mad child god can extend life
			}
			has_game_rule = {
				name = supernatural_events		#require supernatural events game rule
				value = unrestricted
			}
			OR = {
				religion = norse_pagan_reformed	#norse pagan reformed
				#religion = zun_pagan_reformed	#zunist pagan reformed
												#other religions?
			}

			#these two features together are required to gain such control
			has_religion_feature = religion_dogmatic		#must have dogmatic
			has_religion_feature = religion_temporal_head	#secular ruler exists, the Fylkirate

			#The Fylkir must harness the power of the peoples' worship as high god of the religion
			has_religion_feature = religion_holy_family

			controls_religion = yes				#only the Fylkir(a) can do this
		}#end from_potential block

		potential = {
			#Conditions on the targeted character for the decision to appear
			religion = norse_pagan_reformed		#must be germanic reformed pagan to even be an option for the Fylkir
			NOT = { trait = excommunicated }	#must not be excommunicated
			OR = {
				AND = {
					controls_religion = yes		#if proud, ambitious, or greedy, the Fylkir can
					OR = {						#  game it to extend his own life, effectively being immortal
						trait = proud
						trait = ambitious
						trait = greedy
					}
				}
				controls_religion = no			#everyone else
			}
		}#end potential block

		allow = {
			#Conditions for the decision to be enabled

			FROM = {
				piety = 800			#Fylkir must first have at least 800 piety
			}

			OR = {
				FROM = {
					opinion = {
						who = ROOT		#Fylkir opinion of target at least 0...
						value = 0
						}
				}

				AND = {					#OR...
					FROM = {
						opinion = {
						who = ROOT		#Fylkir opinion of target above -25...
						value = -25
						}
					}
					OR = {				#AND target must be some sort of virtuous
						trait = chaste
						trait = temperate
						trait = charitable
						trait = diligent
						trait = patient
						trait = kind
						trait = humble
					}
				}
			}
		}#end allow block

		effect = {
			#Commands executed when taking the decision
			add_age = -2	#age target by -2 years

			FROM = {
				piety = -100	#Fylkir expends 100 piety to extend life
				add_age = 1		#age self by one year
			}
			opinion = {
				modifier = fp_gave_life
				who = FROM
				months = 60
			}
		}#end effect block
	}#end fp_extend_life

	# PASS TRAIT - The Fylkir may, at his discretion, pass own of his/her own traits
	# to the heir, in exchange for 100 piety, and the trait in question.
	fp_pass_trait = {
		filter = dynasty		#Fylkir can pass a trait to any dynasty member
		ai_target_filter = none
		ai_check_interval = 12 # Determines how seldom the AI checks whether they can and should do the decision, in months. By default 1 (every month).
		from_potential = {
			#Conditions on the decision taker for the decision to appear. Not taken into account when filter = self, use potential instead.
			has_dlc = "Holy Fury"				#require the holy fury dlc
			ai = no								#no AI usage
			is_playable = yes					#playable characters only
			OR = {
				is_adult = yes					#adult, no child Fylkirs
				trait = lunatic					#not likely, but mad child god can pass a trait
			}
			has_game_rule = {
				name = supernatural_events		#require supernatural events game rule
				value = unrestricted
			}
			OR = {
				religion = norse_pagan_reformed	#norse pagan reformed
				#religion = zun_pagan_reformed	#zunist pagan reformed
												#other religions?
			}

			#these two features together are required to gain such control
			has_religion_feature = religion_dogmatic		#must have dogmatic
			has_religion_feature = religion_temporal_head	#secular ruler exists, the Fylkirate

			#The Fylkir must harness the power of the peoples' worship as high god of the religion
			has_religion_feature = religion_holy_family

			controls_religion = yes				#only the Fylkir(a) can do this
		}#end from_potential block

		potential = {
			#Conditions on the targeted character for the decision to appear
			religion = norse_pagan_reformed		#must be germanic reformed pagan to even be an option for the Fylkir
			NOT = { trait = excommunicated }	#must not be excommunicated
			is_heir = yes
			#has not recently been passed a trait
			NOT = { has_character_modifier = fp_pass_trait_timer }
			#Fylkir has a trait to pass
			OR = {
				FROM = { trait = sturdy }
				FROM = { trait = robust }
				FROM = { trait = shrewd }
				FROM = { trait = quick }
				FROM = { trait = genius }
				FROM = { trait = strong }
				FROM = { trait = fair }
				AND = {
					FROM = { trait = lunatic } # !!!
					NOT = { trait = lunatic }
				}
			}

		}#end potential block

		allow = {
			#Conditions for the decision to be enabled

			FROM = {
				piety = 800			#Fylkir must first have at least 800 piety
			}

			OR = {
				FROM = {
					opinion = {
						who = ROOT		#Fylkir opinion of target at least 0...
						value = 0
						}
				}

				AND = {					#OR...
					FROM = {
						opinion = {
						who = ROOT		#Fylkir opinion of target above -25...
						value = -25
						}
					}
					OR = {				#AND target must be some sort of virtuous
						trait = chaste
						trait = temperate
						trait = charitable
						trait = diligent
						trait = patient
						trait = kind
						trait = humble
					}
				}
			}
		}#end allow block

		effect = {
			#Commands executed when taking the decision
			#chance to add one of Fylkir's traits to the target
			random_list = {

				#Mid Tier traits - sturdy, robust, shrewd
				50 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { FROM = {trait = sturdy} } 	#Fylkir doesn't have
							trait = sturdy						#target already has
							trait = robust						#brawny is better

						}
					}
					add_trait = sturdy
					FROM = {remove_trait = sturdy}
				}
				50 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { FROM = {trait = robust} } 	#Fylkir doesn't have
							trait = robust						#target already has
						}
					}
					add_trait = robust
					FROM = {remove_trait = robust}
				}
				50 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { FROM = {trait = shrewd} } 	#Fylkir doesn't have
							trait = shrewd						#target already has
						}
					}
					add_trait = shrewd
					FROM = {remove_trait = shrewd}
				}

				#Top Tier traits - quick, genius, strong, fair
				50 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { FROM = {trait = quick} } 	#Fylkir doesn't have
							trait = quick		#target already has
							trait = genius		#genius is better

							#Fylkir still has a mid tier trait
							AND = {
								FROM = {trait = sturdy}	#Fylkir still has sturdy
								NOT = {trait = sturdy}	# and heir doesn't
								NOT = {trait = robust}	# but heir not robust
							}
							AND = {
								FROM = {trait = robust}	#Fylkir still has robust
								NOT = {trait = robust}	# and heir doesn't
							}
							AND = {
								FROM = {trait = shrewd}	#Fylkir still has shrewd
								NOT = {trait = shrewd}	# and heir doesn't
							}
						}
					}
					add_trait = quick
					FROM = {remove_trait = quick}
				}
				50 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { FROM = {trait = genius} } 	#Fylkir doesn't have
							AND = {
								FROM = {trait = genius}	#Fylkir still has genius
								trait = genius			#target already has
							}

							#Fylkir still has a mid tier trait
							AND = {
								FROM = {trait = sturdy}	#Fylkir still has sturdy
								NOT = {trait = sturdy}	# and heir doesn't
								NOT = {trait = robust}	# but heir not robust
							}
							AND = {
								FROM = {trait = robust}	#Fylkir still has robust
								NOT = {trait = robust}	# and heir doesn't
							}
							AND = {
								FROM = {trait = shrewd}	#Fylkir still has shrewd
								NOT = {trait = shrewd}	# and heir doesn't
							}
						}
					}
					add_trait = genius
					FROM = {remove_trait = genius}
				}
				50 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { FROM = {trait = strong} } 	#Fylkir doesn't have
							AND = {
								FROM = {trait = strong}	#Fylkir still has strong
								trait = strong			#target already has
							}

							#Fylkir still has a mid tier trait
							AND = {
								FROM = {trait = sturdy}	#Fylkir still has sturdy
								NOT = {trait = sturdy}	# and heir doesn't
								NOT = {trait = robust}	# but heir not robust
							}
							AND = {
								FROM = {trait = robust}	#Fylkir still has robust
								NOT = {trait = robust}	# and heir doesn't
							}
							AND = {
								FROM = {trait = shrewd}	#Fylkir still has shrewd
								NOT = {trait = shrewd}	# and heir doesn't
							}
						}
					}
					add_trait = strong
					FROM = {remove_trait = strong}
				}
				50 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { FROM = {trait = fair} } 	#Fylkir doesn't have
							AND = {
								FROM = {trait = fair}	#Fylkir still has fair
								trait = fair			#target already has
							}

							#Fylkir still has a mid tier trait
							AND = {
								FROM = {trait = sturdy}	#Fylkir still has sturdy
								NOT = {trait = sturdy}	# and heir doesn't
								NOT = {trait = robust}	# but heir not robust
							}
							AND = {
								FROM = {trait = robust}	#Fylkir still has robust
								NOT = {trait = robust}	# and heir doesn't
							}
							AND = {
								FROM = {trait = shrewd}	#Fylkir still has shrewd
								NOT = {trait = shrewd}	# and heir doesn't
							}
						}
					}
					add_trait = fair
					FROM = {remove_trait = fair}
				}

				#Immortality, last in line
				50 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { FROM = {trait = immortal} } #Fylkir doesn't have
							AND = {
								FROM = {trait = immortal}	#Fylkir still has immortal
								trait = immortal			#target already has
							}

							#Fylkir still has a mid tier trait
							AND = {
								FROM = {trait = sturdy}	#Fylkir still has sturdy
								NOT = {trait = sturdy}	# and heir doesn't
								NOT = {trait = robust}	# but heir not robust
							}
							AND = {
								FROM = {trait = robust}	#Fylkir still has robust
								NOT = {trait = robust}	# and heir doesn't
							}
							AND = {
								FROM = {trait = shrewd}	#Fylkir still has shrewd
								NOT = {trait = shrewd}	# and heir doesn't
							}

							#Fylkir still has a top tier trait
							AND = {
								FROM = {trait = quick}	#Fylkir still has quick
								NOT = {trait = quick}	# and heir doesn't
								NOT = {trait = genius}	# but heir not genius
							}
							AND = {
								FROM = {trait = genius}	#Fylkir still has genius
								NOT = {trait = genius}	# and heir doesn't
							}
							AND = {
								FROM = {trait = fair}	#Fylkir still has fair
								NOT = {trait = fair}	# and heir doesn't
							}
							AND = {
								FROM = {trait = strong}	#Fylkir still has strong
								NOT = {trait = strong}	# and heir doesn't
							}
						}
					}
					add_trait = immortal
					FROM = {remove_trait = immortal}
				}

				#lunatic, really last in line, if it's there
				50 = {
					modifier = {
						factor = 0
						OR = {
							NOT = { FROM = {trait = lunatic} } #Fylkir doesn't have
							AND = {
								FROM = {trait = lunatic}	#Fylkir still has lunatic
								trait = lunatic			#target already has
							}

							#Fylkir still has a mid tier trait
							AND = {
								FROM = {trait = sturdy}	#Fylkir still has sturdy
								NOT = {trait = sturdy}	# and heir doesn't
								NOT = {trait = robust}	# but heir not robust
							}
							AND = {
								FROM = {trait = robust}	#Fylkir still has robust
								NOT = {trait = robust}	# and heir doesn't
							}
							AND = {
								FROM = {trait = shrewd}	#Fylkir still has shrewd
								NOT = {trait = shrewd}	# and heir doesn't
							}

							#Fylkir still has a top tier trait
							AND = {
								FROM = {trait = quick}	#Fylkir still has quick
								NOT = {trait = quick}	# and heir doesn't
								NOT = {trait = genius}	# but heir not genius
							}
							AND = {
								FROM = {trait = genius}	#Fylkir still has genius
								NOT = {trait = genius}	# and heir doesn't
							}
							AND = {
								FROM = {trait = fair}	#Fylkir still has fair
								NOT = {trait = fair}	# and heir doesn't
							}
							AND = {
								FROM = {trait = strong}	#Fylkir still has strong
								NOT = {trait = strong}	# and heir doesn't
							}

							#Fylkir still has immortal
							AND = {
								FROM = {trait = immortal}	#Fylkir still has immortal
								NOT = {trait = immortal}	# and heir doesn't
							}
						}
					}
					add_trait = lunatic
					#FROM = {remove_trait = lunatic} #lunacy loves company
				}




			}

			FROM = {
				piety = -100	#Fylkir expends 100 piety to pass trait
			}
			opinion = {
				modifier = fp_gave_trait
				who = FROM
				months = 60
			}
			add_character_modifier = {
				name = fp_pass_trait_timer
				months = 12
				hidden = yes
			}
		}#end effect block
	}#end fp_pass_trait


	### CURSES INFLICTED BY FYLKIR ###

	# INFLICT GLOOM - The Fylkir may, at his discretion, inflict stressed or depression
	# upon a member of the faith, in exchange for 75 piety.
	fp_inflict_gloom = {
		filter = all
		ai_target_filter = self
		ai_check_interval = 12 # Determines how seldom the AI checks whether they can and should do the decision, in months. By default 1 (every month).
		from_potential = {
			#Conditions on the decision taker for the decision to appear. Not taken into account when filter = self, use potential instead.
			has_dlc = "Holy Fury"				#require the holy fury dlc
			ai = no								#no AI usage
			is_playable = yes					#playable characters only
			OR = {
				is_adult = yes					#adult, no child Fylkirs
				trait = lunatic					#mad child god can inflict
			}
			has_game_rule = {
				name = supernatural_events		#require supernatural events game rule
				value = unrestricted
			}
			OR = {
				religion = norse_pagan_reformed	#norse pagan reformed
				#religion = zun_pagan_reformed	#zunist pagan reformed
												#other religions?
			}

			OR = {					#must have one of these traits to inflict stuff
				trait = cruel
				trait = wroth
				trait = arbitrary
				trait = lunatic
				trait = possessed
			}
			#these two features together are required to gain such control
			has_religion_feature = religion_dogmatic		#must have dogmatic
			has_religion_feature = religion_temporal_head	#secular ruler exists, the Fylkirate

			OR = {
				#The Fylkir must harness the power of the peoples' worship as high god of the religion
				has_religion_feature = religion_holy_family

				#Alternatively, the Fylkir may be a rank 1 devil worshiper
				AND = {
					society_is_devil_worshiper = yes
					society_rank >= 1
				}
			}

			controls_religion = yes				#only the Fylkir(a) can do this
		}#end from_potential block

		potential = {
			#Conditions on the targeted character for the decision to appear
			religion = norse_pagan_reformed		#must be germanic reformed pagan to even be an option for the Fylkir
		}#end potential block

		allow = {
			#Conditions for the decision to be enabled

			FROM = {
				piety = 300			#Fylkir must first have at least 300 piety
			}

			OR = {
				FROM = {
					NOT = {
						opinion = {
						who = ROOT		#Fylkir opinion of target below 0...
						value = 0		#if yes, we don't care if they are a sinner
						}
					}
				}
				AND = {					#OR...
					FROM = {
						NOT = {
							opinion = {
							who = ROOT	#Fylkir opinion of target below 25...
							value = 25
							}
						}
					}
					OR = {				#AND target must be some sort of sinner
						trait = gluttonous
						trait = proud
						trait = envious
						trait = lustful
						trait = greedy
						trait = slothful
						trait = wroth
						trait = lovers_pox	#adultery!
					}
				}
			}
		}#end allow block

		effect = {
			#Commands executed when taking the decision

			#chance to add one of either trait to the target
			random_list = {
				50 = {
					modifier = {
						factor = 0			#if already have depressed, skip
						trait = depressed
					}
					add_trait = depressed		#50% chance to add the depressed trait to the target
				}
				50 = {
					modifier = {
						factor = 0			#if already have stressed, skip
						trait = stressed
					}
					add_trait = stressed	#50% chance to add the stressed trait to the target
				}
			}

			FROM = {
				piety = -75		#Fylkir expends 75 piety to inflict gloom
			}
		}#end effect block
	}#end fp_inflict_gloom

	# INFLICT MADNESS - The Fylkir may, at his discretion, inflict lunacy or possession
	# upon a member of the faith, in exchange for 75 piety.
	fp_inflict_madness = {
		filter = all
		ai_target_filter = self
		ai_check_interval = 12 # Determines how seldom the AI checks whether they can and should do the decision, in months. By default 1 (every month).
		from_potential = {
			#Conditions on the decision taker for the decision to appear. Not taken into account when filter = self, use potential instead.
			has_dlc = "Holy Fury"				#require the holy fury dlc
			ai = no								#no AI usage
			is_playable = yes					#playable characters only
			OR = {
				is_adult = yes					#adult, no child Fylkirs
				trait = lunatic					#mad child god can inflict
			}
			has_game_rule = {
				name = supernatural_events		#require supernatural events game rule
				value = unrestricted
			}
			OR = {
				religion = norse_pagan_reformed	#norse pagan reformed
				#religion = zun_pagan_reformed	#zunist pagan reformed
												#other religions?
			}

			OR = {					#must have one of these traits to inflict stuff
				trait = cruel
				trait = wroth
				trait = arbitrary
				trait = lunatic
				trait = possessed
			}
			#these two features together are required to gain such control
			has_religion_feature = religion_dogmatic		#must have dogmatic
			has_religion_feature = religion_temporal_head	#secular ruler exists, the Fylkirate

			OR = {
				#The Fylkir must harness the power of the peoples' worship as high god of the religion
				has_religion_feature = religion_holy_family

				#Alternatively, the Fylkir may be a rank 2 devil worshiper
				AND = {
					society_is_devil_worshiper = yes
					society_rank >= 2
				}
			}

			controls_religion = yes				#only the Fylkir(a) can do this
		}#end from_potential block

		potential = {
			#Conditions on the targeted character for the decision to appear
			religion = norse_pagan_reformed		#must be germanic reformed pagan to even be an option for the Fylkir
		}#end potential block

		allow = {
			#Conditions for the decision to be enabled

			FROM = {
				piety = 300			#Fylkir must first have at least 300 piety
			}

			OR = {
				FROM = {
					NOT = {
						opinion = {
						who = ROOT		#Fylkir opinion of target below 0...
						value = 0		#if yes, we don't care if they are a sinner
						}
					}
				}
				AND = {					#OR...
					FROM = {
						NOT = {
							opinion = {
							who = ROOT	#Fylkir opinion of target below 25...
							value = 25
							}
						}
					}
					OR = {				#AND target must be some sort of sinner
						trait = gluttonous
						trait = proud
						trait = envious
						trait = lustful
						trait = greedy
						trait = slothful
						trait = wroth
						trait = lovers_pox	#adultery!
					}
				}
			}
		}#end allow block

		effect = {
			#Commands executed when taking the decision

			#chance to add one of either trait to the target
			random_list = {
				50 = {
					modifier = {
						factor = 0			#if already have lunatic, skip
						trait = lunatic
					}
					add_trait = lunatic		#50% chance to add the lunatic trait to the target
				}
				50 = {
					modifier = {
						factor = 0			#if already have possessed, skip
						trait = possessed
					}
					add_trait = possessed	#50% chance to add the possessed trait to the target
				}
			}

			FROM = {
				piety = -75		#Fylkir expends 75 piety to inflict madness
			}
		}#end effect block
	}#end fp_inflict_illness

	# INFLICT ILLNESS - The Fylkir may, at his discretion, inflict a minor disease
	# (-2 or -3 health) upon a member of the faith, in exchange for 75 piety.
	fp_inflict_illness = {
		filter = all
		ai_target_filter = self
		ai_check_interval = 12 # Determines how seldom the AI checks whether they can and should do the decision, in months. By default 1 (every month).
		from_potential = {
			#Conditions on the decision taker for the decision to appear. Not taken into account when filter = self, use potential instead.
			has_dlc = "Holy Fury"				#require the holy fury dlc
			ai = no								#no AI usage
			is_playable = yes					#playable characters only
			OR = {
				is_adult = yes					#adult, no child Fylkirs
				trait = lunatic					#mad child god can inflict
			}
			has_game_rule = {
				name = supernatural_events		#require supernatural events game rule
				value = unrestricted
			}
			OR = {
				religion = norse_pagan_reformed	#norse pagan reformed
				#religion = zun_pagan_reformed	#zunist pagan reformed
												#other religions?
			}

			OR = {					#must have one of these traits to inflict stuff
				trait = cruel
				trait = wroth
				trait = arbitrary
				trait = lunatic
				trait = possessed
			}
			#these two features together are required to gain such control
			has_religion_feature = religion_dogmatic		#must have dogmatic
			has_religion_feature = religion_temporal_head	#secular ruler exists, the Fylkirate

			OR = {
				#The Fylkir must harness the power of the peoples' worship as high god of the religion
				has_religion_feature = religion_holy_family

				#Alternatively, the Fylkir may be a rank 3 devil worshiper
				AND = {
					society_is_devil_worshiper = yes
					society_rank >= 3
				}
			}

			controls_religion = yes				#only the Fylkir(a) can do this
		}#end from_potential block

		potential = {
			#Conditions on the targeted character for the decision to appear
			religion = norse_pagan_reformed		#must be germanic reformed pagan to even be an option for the Fylkir
		}#end potential block

		allow = {
			#Conditions for the decision to be enabled

			FROM = {
				piety = 300			#Fylkir must first have at least 300 piety
			}

			OR = {
				FROM = {
					NOT = {
						opinion = {
						who = ROOT		#Fylkir opinion of target below 0...
						value = 0		#if yes, we don't care if they are a sinner
						}
					}
				}
				AND = {					#OR...
					FROM = {
						NOT = {
							opinion = {
							who = ROOT	#Fylkir opinion of target below 25...
							value = 25
							}
						}
					}
					OR = {				#AND target must be some sort of sinner
						trait = gluttonous
						trait = proud
						trait = envious
						trait = lustful
						trait = greedy
						trait = slothful
						trait = wroth
						trait = lovers_pox	#adultery!
					}
				}
			}
		}#end allow block

		effect = {
			#Commands executed when taking the decision

			# adds a minor disease (-2 and -3 health) to the target from a random list
			# -2 health diseases are slightly more likely, weighted with 3
			# -3 health diseases are slightly less likely, weighted with 2
			random_list = {
				3 = {
					modifier = {
						factor = 0			#skip if already have consumption (-2)
						trait = has_tuberculosis
					}
					add_trait = has_tuberculosis
				}
				3 = {
					modifier = {
						factor = 0			#skip if already have dancing plague (-2)
						trait = dancing_plague
					}
					add_trait = dancing_plague
				}
				3 = {
					modifier = {
						factor = 0			#skip if already have flu (-2)
						trait = flu
					}
					add_trait = flu
				}
				2 = {
					modifier = {
						factor = 0			#skip if already have cancer (-3)
						trait = cancer
					}
					add_trait = cancer
				}
				2 = {
					modifier = {
						factor = 0			#skip if already have food poisoning (-3)
						trait = food_poisoning
					}
					add_trait = food_poisoning
				}
				3 = {
					modifier = {
						factor = 0			#skip if already have gout (-2)
						trait = gout
					}
					add_trait = gout
				}
				3 = {
					modifier = {
						factor = 0			#skip if already have great pox (-2)
						trait = syphilitic
					}
					add_trait = syphilitic
				}
				2 = {
					modifier = {
						factor = 0			#skip if already have slow fever (-3)
						trait = has_typhoid_fever
					}
					add_trait = has_typhoid_fever
				}
				3 = {
					modifier = {
						factor = 0			#skip if already have measles (-2)
						trait = has_measles
					}
					add_trait = has_measles
				}
				2 = {
					modifier = {
						factor = 0			#skip if already have scurvy (-3)
						trait = scurvy
					}
					add_trait = scurvy
				}
				2 = {
					modifier = {
						factor = 0			#skip if already have small pox (-3)
						trait = has_small_pox
					}
					add_trait = has_small_pox
				}
				3 = {
					modifier = {
						factor = 0			#skip if already have leper (-1.5)
						trait = leper		#treat like (-2)
					}
					add_trait = leper
				}
				3 = {
					modifier = {
						factor = 0			#skip if already have infection (-2)
						trait = infection
					}
					add_trait = infection
				}
				1 = {
					modifier = {
						factor = 0			#skip if already have lovers_pox (N/A)
						trait = lovers_pox	#treat not very likely, since this counts as a "sin"
					}
					add_trait = lovers_pox
				}
			}
			FROM = {
				piety = -75		#Fylkir expends 75 piety to inflict an illness
			}
		}#end effect block
	}#end fp_inflict_illness

	# INFLICT MALADY - The Fylkir may, at his discretion, inflict a major disease
	# (-4 health and above) upon a member of the faith, in exchange for 100 piety.
	fp_inflict_malady = {
		filter = all
		ai_target_filter = self
		ai_check_interval = 12 # Determines how seldom the AI checks whether they can and should do the decision, in months. By default 1 (every month).
		from_potential = {
			#Conditions on the decision taker for the decision to appear. Not taken into account when filter = self, use potential instead.
			has_dlc = "Holy Fury"				#require the holy fury dlc
			ai = no								#no AI usage
			is_playable = yes					#playable characters only
			OR = {
				is_adult = yes					#adult, no child Fylkirs
				trait = lunatic					#mad child god can inflict
			}
			has_game_rule = {
				name = supernatural_events		#require supernatural events game rule
				value = unrestricted
			}
			OR = {
				religion = norse_pagan_reformed	#norse pagan reformed
				#religion = zun_pagan_reformed	#zunist pagan reformed
												#other religions?
			}

			OR = {					#must have one of these traits to inflict stuff
				trait = cruel
				trait = wroth
				trait = arbitrary
				trait = lunatic
				trait = possessed
			}
			#these two features together are required to gain such control
			has_religion_feature = religion_dogmatic		#must have dogmatic
			has_religion_feature = religion_temporal_head	#secular ruler exists, the Fylkirate

			OR = {
				#The Fylkir must harness the power of the peoples' worship as high god of the religion
				has_religion_feature = religion_holy_family

				#Alternatively, the Fylkir may be a rank 4 devil worshiper
				AND = {
					society_is_devil_worshiper = yes
					society_rank >= 4
				}
			}

			controls_religion = yes				#only the Fylkir(a) can do this
		}#end from_potential block

		potential = {
			#Conditions on the targeted character for the decision to appear
			religion = norse_pagan_reformed		#must be germanic reformed pagan to even be an option for the Fylkir
		}#end potential block

		allow = {
			#Conditions for the decision to be enabled

			FROM = {
				piety = 400			#Fylkir must first have at least 400 piety
			}

			OR = {
				FROM = {
					NOT = {
						opinion = {
						who = ROOT		#Fylkir opinion of target below 0...
						value = 0		#if yes, we don't care if they are a sinner
						}
					}
				}
				AND = {					#OR...
					FROM = {
						NOT = {
							opinion = {
							who = ROOT	#Fylkir opinion of target below 25...
							value = 25
							}
						}
					}
					OR = {				#AND target must be some sort of sinner
						trait = gluttonous
						trait = proud
						trait = envious
						trait = lustful
						trait = greedy
						trait = slothful
						trait = wroth
						trait = lovers_pox	#adultery!
					}
				}
			}
		}#end allow block

		effect = {
			#Commands executed when taking the decision

			# adds a minor disease (-2 and -3 health) to the target from a random list
			# -4 health diseases are slightly more likely, weighted with 3
			# -7 health diseases are slightly less likely, weighted with 2
			random_list = {
				3 = {
					modifier = {
						factor = 0			#skip if already have aztec disease (-4)
						trait = has_aztec_disease
					}
					modifier = {
						factor = 0					#skip if aztec dlc is off
						has_dlc = "Sunset Invasion"	#require the sunset invasion dlc
					}
					modifier = {
						factor = 0			#skip if aztec invasion is off
						has_game_rule = {
							name = aztec_invasion
							value = off
						}
					}
					add_trait = has_aztec_disease
				}
				3 = {
					modifier = {
						factor = 0			#skip if already have camp fever (-4)
						trait = has_typhus
					}
					add_trait = has_typhus
				}
				3 = {
					modifier = {
						factor = 0			#skip if already pneumonic (-4)
						trait = pneumonic
					}
					add_trait = pneumonic
				}
				3 = {
					modifier = {
						factor = 0			#skip if already have dysentery (-4)
						trait = dysentery
					}
					add_trait = dysentery
				}
				2 = {
					modifier = {
						factor = 0			#skip if already have rabies (-7)
						trait = rabies
					}
					add_trait = rabies
				}
				2 = {
					modifier = {
						factor = 0			#skip if already have the plague (-7)
						trait = has_bubonic_plague
					}
					add_trait = has_bubonic_plague
				}
			}#end random_list

			FROM = {
				piety = -100		#Fylkir expends 100 piety to inflict a major disease
			}
		}#end effect block
	}#end fp_inflict_malady

	# INFLICT ABERRATION - The Fylkir may, at his discretion, inflict an aberration
	# or deformity upon a member of the faith, in exchange for 200 piety.
	fp_inflict_aberration = {
		filter = all
		ai_target_filter = self
		ai_check_interval = 12 # Determines how seldom the AI checks whether they can and should do the decision, in months. By default 1 (every month).
		from_potential = {
			#Conditions on the decision taker for the decision to appear. Not taken into account when filter = self, use potential instead.
			has_dlc = "Holy Fury"				#require the holy fury dlc
			ai = no								#no AI usage
			is_playable = yes					#playable characters only
			OR = {
				is_adult = yes					#adult, no child Fylkirs
				trait = lunatic					#mad child god can inflict
			}
			has_game_rule = {
				name = supernatural_events		#require supernatural events game rule
				value = unrestricted
			}
			OR = {
				religion = norse_pagan_reformed	#norse pagan reformed
				#religion = zun_pagan_reformed	#zunist pagan reformed
												#other religions?
			}

			OR = {					#must have one of these traits to inflict stuff
				trait = cruel
				trait = wroth
				trait = arbitrary
				trait = lunatic
				trait = possessed
			}
			#these two features together are required to gain such control
			has_religion_feature = religion_dogmatic		#must have dogmatic
			has_religion_feature = religion_temporal_head	#secular ruler exists, the Fylkirate

			OR = {
				#The Fylkir must harness the power of the peoples' worship as high god of the religion
				has_religion_feature = religion_holy_family

				#Alternatively, the Fylkir may be a rank 4 devil worshiper
				AND = {
					society_is_devil_worshiper = yes
					society_rank >= 4
				}
			}

			controls_religion = yes				#only the Fylkir(a) can do this
		}#end from_potential block

		potential = {
			#Conditions on the targeted character for the decision to appear
			religion = norse_pagan_reformed		#must be germanic reformed pagan to even be an option for the Fylkir
		}#end potential block

		allow = {
			#Conditions for the decision to be enabled

			FROM = {
				piety = 500			#Fylkir must first have at least 500 piety
			}

			OR = {
				FROM = {
					NOT = {
						opinion = {
						who = ROOT		#Fylkir opinion of target below 0...
						value = 0		#if yes, we don't care if they are a sinner
						}
					}
				}
				AND = {					#OR...
					FROM = {
						NOT = {
							opinion = {
							who = ROOT	#Fylkir opinion of target below 25...
							value = 25
							}
						}
					}
					OR = {				#AND target must be some sort of sinner
						trait = gluttonous
						trait = proud
						trait = envious
						trait = lustful
						trait = greedy
						trait = slothful
						trait = wroth
						trait = lovers_pox	#adultery!
					}
				}
			}
		}#end allow block

		effect = {
			#Commands executed when taking the decision

			# adds a defect or aberration to the target from a random_list
			# clubfooted, harelip, hunchback, stutter, and lisp are more likely, weighted with 3
			# ugly, dwarf, giant are less likely, weighted with 2 (under age 6 only)
			# imbecile, weak, and slow are unlikely, weighted with 1
			random_list = {
				3 = {
					modifier = {
						factor = 0			#skip if already clubfooted
						trait = clubfooted
					}
					add_trait = clubfooted
				}
				3 = {
					modifier = {
						factor = 0			#skip if already have a harelip
						trait = harelip
					}
					add_trait = harelip
				}
				3 = {
					modifier = {
						factor = 0			#skip if already a hunchback
						trait = hunchback
					}
					add_trait = hunchback
				}
				3 = {
					modifier = {
						factor = 0			#skip if already have a stutter
						trait = stutter
					}
					add_trait = stutter
				}
				3 = {
					modifier = {
						factor = 0			#skip if already have a lisp
						trait = lisp
					}
					add_trait = lisp
				}
				2 = {
					modifier = {
						factor = 0			#skip if already ugly
						trait = ugly
					}
					modifier = {
						factor = 0			#skip if already age 6
						age = 6
					}
					add_trait = ugly
				}
				2 = {
					modifier = {
						factor = 0			#skip if already dwarf
						trait = dwarf
					}
					modifier = {
						factor = 0			#skip if already age 6
						age = 6
					}
					add_trait = dwarf
				}
				2 = {
					modifier = {
						factor = 0			#skip if already giant
						trait = giant
					}
					modifier = {
						factor = 0			#skip if already age 6
						age = 6
					}
					add_trait = giant
				}
				1 = {
					modifier = {
						factor = 0			#skip if already an imbecile
						trait = imbecile
					}
					add_trait = imbecile
				}
				1 = {
					modifier = {
						factor = 0			#skip if already weak
						trait = weak
					}
					add_trait = weak
				}
				1 = {
					modifier = {
						factor = 0			#skip if already slow
						trait = slow
					}
					add_trait = slow
				}
			}#end random_list

			FROM = {
				piety = -200		#Fylkir expends 200 piety to inflict a defect
			}
		}#end effect block
	}#end fp_inflict_aberration


	### BLINDING AND CASTRATION ###

	# Trying by replacing the in game version, first
	# Castration - Replaces Default
	vassal_castrate_decision = {
		only_playable = yes
		filter = court
		ai_target_filter = court
		ai_check_interval = 6

		from_potential = {
			has_dlc = "Legacy of Rome"
			is_playable = yes
			OR = {
				culture_group = byzantine
				culture_group = chinese_group
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_castration
				}
				religion_head = {
					has_law = fp_crime_punish_law_2
				}
			}
		}

		potential = {
			host = { character = FROM }
			prisoner = yes
			is_female = no
			NOT = { trait = eunuch }
		}
		allow = {
			prisoner = yes
		}
		effect = {
			hidden_tooltip = {
				if = {
					limit = { age = 16}
					FROM = {
						character_event = { id = LoR.832 }
					}
				}
				if = {
					limit = { NOT = { age = 16 } }
					FROM = {
						character_event = { id = LoR.834 }
					}
				}
				character_event = { id = LoR.833 tooltip = "EVTTOOLTIPLoR.833" }
			}
			add_trait = eunuch
			if = {
				limit = {
					has_game_rule = {
						name = punishment_release_prisoner
						value = on
					}
				}
				prisoner = no
			}
			opinion = {
				modifier = opinion_castrated_me
				who = FROM
			}
			FROM = {
				if = {
					limit = { NOT = { trait = cruel } }
					custom_tooltip = {
						text = cruel_imprisoner_trait_chance_TT
						random = {
							chance = 25
							add_trait = cruel
							hidden_tooltip = {
								character_event = { id = 38259 }
							}
						}
					}
				}
				piety = -50
			}
			hidden_tooltip = {
				mother = {
					opinion = {
						modifier = opinion_castrated_close_kin
						who = FROM
					}
				}
				father = {
					opinion = {
						modifier = opinion_castrated_close_kin
						who = FROM
					}
				}
				spouse = {
					opinion = {
						modifier = opinion_castrated_close_kin
						who = FROM
					}
				}
				any_child = {
					opinion = {
						modifier = opinion_castrated_close_kin
						who = FROM
					}
				}
				if = {
					limit = {
						FROM = {
							NOT = { dynasty = ROOT }
							NOT = { sibling = ROOT }
						}
					}
					any_sibling = {
						opinion = {
							modifier = opinion_castrated_close_kin
							who = FROM
						}
					}
					any_dynasty_member = {
						opinion = {
							modifier = opinion_castrated_family
							who = FROM
						}
					}
				}
				FROM = {
					remove_opinion = { who = ROOT modifier = opinion_traitor }
					remove_opinion = { who = ROOT modifier = opinion_rebel_traitor }
					remove_opinion = { who = ROOT modifier = opinion_dishonorable }
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1

			modifier = {
				factor = 0
				OR = {
					reverse_opinion = { who = FROM value = 40 }
					FROM = { NOT = { piety = 100 } }
					FROM = { LIEGE = { dynasty = ROOT } }
				}
			}
			modifier = {
				factor = 0
				FROM = { trait = kind }
			}
			modifier = {
				factor = 0.4 # Less likely to do it
			}				 # Game default is 0.5
			modifier = {
				factor = 1.2
				FROM = {
					OR = {
						trait = cruel
						trait = impaler
					}
				}
			}
		}
	}#end vassal_castrate_decision

	# Blinding - Replaces Default
	vassal_blinding_decision = {
		only_playable = yes
		filter = court
		ai_target_filter = court
		ai_check_interval = 6

		from_potential = {
			has_dlc = "Legacy of Rome"
			is_playable = yes
			OR = {
				culture_group = byzantine
				any_owned_bloodline = {
					has_bloodline_flag = bloodline_blinding
				}
				religion_head = {
					OR = {
						has_law = fp_crime_punish_law_1
						has_law = fp_crime_punish_law_2
					}
				}
			}
		}

		potential = {
			host = { character = FROM }
			prisoner = yes
			NOT = { trait = blinded }
		}
		allow = {
			prisoner = yes
		}
		effect = {
			hidden_tooltip = {
				FROM = {
					character_event = { id = LoR.830 }
				}
				character_event = { id = LoR.831 tooltip = "EVTTOOLTIPLoR.831" }
			}
			if = {
				limit = {
					trait = one_eyed
				}
				remove_trait = one_eyed
			}
			add_trait = blinded
			if = {
				limit = {
					has_game_rule = {
						name = punishment_release_prisoner
						value = on
					}
				}
				prisoner = no
			}
			opinion = {
				modifier = opinion_blinded_me
				who = FROM
			}
			FROM = {
				if = {
					limit = { NOT = { trait = cruel } }
					custom_tooltip = {
						text = cruel_imprisoner_trait_chance_TT
						random = {
							chance = 25
							add_trait = cruel
							hidden_tooltip = {
								character_event = { id = 38259 }
							}
						}
					}
				}
				piety = -50
			}
			hidden_tooltip = {
				mother = {
					opinion = {
						modifier = opinion_blinded_close_kin
						who = FROM
					}
				}
				father = {
					opinion = {
						modifier = opinion_blinded_close_kin
						who = FROM
					}
				}
				spouse = {
					opinion = {
						modifier = opinion_blinded_close_kin
						who = FROM
					}
				}
				any_child = {
					opinion = {
						modifier = opinion_blinded_close_kin
						who = FROM
					}
				}
				if = {
					limit = {
						FROM = {
							NOT = { dynasty = ROOT }
							NOT = { sibling = ROOT }
						}
					}
					any_sibling = {
						opinion = {
							modifier = opinion_blinded_close_kin
							who = FROM
						}
					}
					any_dynasty_member = {
						opinion = {
							modifier = opinion_blinded_family
							who = FROM
						}
					}
				}
				FROM = {
					remove_opinion = { who = ROOT modifier = opinion_traitor }
					remove_opinion = { who = ROOT modifier = opinion_rebel_traitor }
					remove_opinion = { who = ROOT modifier = opinion_dishonorable }
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1

			modifier = {
				factor = 0
				OR = {
					reverse_opinion = { who = FROM value = 40 }
					FROM = { NOT = { piety = 100 } }
					FROM = { LIEGE = { dynasty = ROOT } }
				}
			}
			modifier = {
				factor = 0
				FROM = { trait = kind }
			}
			modifier = {
				factor = 0.4 # Less likely to do it
			}				 # Game default is 0.5
			modifier = {
				factor = 2
				is_pretender = yes
				FROM = {
					OR = {
						is_pretender = yes
						is_primary_heir = yes
					}
				}
			}
		}
	}# end vassal_blinding_decision

}#end targeted_decisions
